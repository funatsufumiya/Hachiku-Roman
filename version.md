## おもな修正履歴

### 2022年5月7日 v1.9-beta.3
* Google 日本語入力対応の設定を追加
* 左右のシフトを押しながらアルファベットを押すと、一時的に半角英数入力ができるのを初期設定とした。（左右シフト「英数」）
* 「ので」を打ちやすくしていたのを、初期設定では DvorakJ 版に合わせるために取りやめた。

### 2022年3月28日 v1.8.5
* ATOKで「後でカッコ付け」が失敗する問題を解消

### 2022年3月21日 v1.8.4
* 編集モードの記号入力の速度改善(ブラウザを除く)
* 「後からカッコ付け」の動作修復

### 2022年3月19日 v1.8.3
* IME窓検知の修復
* ブラウザ上でGitHubのファイル修正するときに、編集モードの記号入力が予期せぬ動作を引き起こさないようにした。

### 2022年3月6日 v1.8.2
* 「以前のバージョンの Microsoft IME を使う」設定があるのに一度もオンにしたことがないパソコンで不具合を修正
* 「シフト+スペース」と「シフト+矢印」と、押した後の動作修正

### 2022年3月3日 v1.8.1
* 縦書き・横書きでタスクトレイのアイコンが変化するようにした
* Hachiku があるパス名にスペースが含まれると iniファイルの読み書きができなかったのを修正

### 2022年3月1日 v1.8

* 秀丸エディタのカーソル加速への対応(方向キーのリピートが、キーを上げることなく連打するように)
* 左右シフト「英数２」にした時のレジストリの編集を不要にした
* 設定によっては、キーの上げ下げのタイミングから出力が持ち越しになってしまう不具合を解消
* 左右シフトを押しながら英字を入力し始め、わずかでも間をおいてから超高速で英字を入力したときは、ローマ字にならなくした

間を開けずに、超高速英字入力すると誤作動を避けられません。

### 2022年2月6日 v1.7.6
* 「後置シフトの待ち時間」「同時打鍵判定」の時間が「未満」だったのを「以下」にした
* ログ表示(直前のキー入力31個分)を追加
* 新MS-IMEで、変換候補窓が最大のときに、確定せず編集モードの記号を入力すると、未変換のまま記号が前に入るを修正
* 配列変換しないでまれに素通りするのを対策
* テストモードを見えなくした

### 2022年1月4日 v1.7.5
* 後置シフト、同時打鍵判定 Issue #21 の修正
* タイマー割込みとキー割込みの行き違いが起きうる Issue #19 のを修正
* 文字キーシフト「同グループのみ継続」の動作を再修正

### 2021年12月31日 v1.7.3
* 1キー→2キー の時、1キーの文字が確定しているのに出力されなかったので修正
薙刀式で、I押→J押→E押 の時点で「る」は出力したい。「で」はまだ確定していない。

### 2021年12月29日 v1.7.2
* 文字キーシフト「同グループのみ継続」の動作を修正
* キーリピートが始まる時に2文字出力されることがないようにした

### 2021年12月20日 v1.7.1
* 入力取りこぼしを減らした

### 2021年12月11日 v1.7

### 2021年11月23日
* 英数時の同時打鍵期限を強制する設定を作った

### 2021年11月3日
* スペースキーの長押しを 0: 何もしない, 1: 空白キャンセル, 2: 空白リピート から設定で選ぶ
* 詳細メニューの変更
1. 同時打鍵の判定期限を通常面、スペース押下時それぞれでオンオフ切り替え可能に
2. 文字キーシフトを 0: ずっと, 1: 途切れるまで, 2: 同グループのみ継続, 3: 1回のみ から選べる
3. キーを離したときに文字キーシフトを 0: 全復活, 1: そのまま, 2: 全解除 から選べる
4. これまで「出力済みのキーを上げても全部出力する」だけだったが、しなくもできる
* かな定義に使えるものを追加
1. {NoIME}、{UndoIME}：
{NoIME} でユニコード文字を出力するために入力モードを控えてから IMEオフ にし、対する {UndoIME} は IMEオンにして入力モードを元に戻す。
通常、ユニコード文字が定義にあると自動で適用されるので、IME にローマ字を渡して入力モードに合わせた変換をしたいときなどに {UndoIME} を使う。
2. {IMEOFF}：
IME.ahk の関数で IMEオフ にする
3. {IMEON}：
IME.ahk の関数で IMEオン にする
4. {全英}：
IME.ahk の関数で 全角英数入力モード にする
5. {半ｶﾅ}：
IME.ahk の関数で 半角カタカナモード にする

### 2021年10月24日
 * (10日より)IME窓の有無をIME.ahkを使って判定していいかを見極めるルーチンを追加、(24日)見極めの精度を上げた

### 2021年10月17日
* 英数入力時のSandSをオフにする設定項目を作った

### 2021年10月2日
* 縦書き・横書きでまるで違う定義を登録する関数を追加

SetKana2(キービットの集合, 縦書き, 横書き, コントロール)

SetEisu2(キービットの集合, 縦書き, 横書き, コントロール)

従来からの SetKana()、SetEisu() は縦書き用からカーソル移動の向きを変換しています。

### 2021年10月1日
* スペースキーのリピートをオンオフできる設定を追加

スペースキーのリピート中の日本語入力は、変換取消してシフト側文字が出力されます。

### 2021年9月21日
* 固有名詞ショートカットのシフト面（スペース押下）を追加

### 2021年9月8日
* 配列の定義を書き換えるのに src¥KanaTable¥ 内の定義1ファイルだけで良くなるよう、サブルーチンを関数に書き換え、ファイル構成を改めた。
* そのため、これまでのバージョンの配列定義ファイルからは書き換えが必要です。
* MS-IMEの新旧バージョンをときどき自動検知して、編集モード、固有名詞ショートカットの速さを最適化 (将来の Windows に対応できるかは不明)

### 2021年8月28日
* 漢字変換中に英数入力に切り替え編集モードの記号を入力すると、記号は未確定で、かな入力のままになるバグを修正
* 薙刀式中断 Shift+Ctrl+0、薙刀式再開 Shift+Ctrl+1 の実装
* DvrakJ版の定義とコメントの順番に直した

### 2021年7月21日
* 左右シフトかなを初期設定とした
* スペース＋エンターを Shift+Enter に変換するようにした
* 2キー同時押しの次に押したキーが1キー単打だったら、前の文字を出力して Issue #7 を回避する

### 2021年7月18日
* 固有名詞ショートカットの変更画面を作った。

### 2021年7月10日
* Enterキーをシフトを兼ねられるようにした。
* トレイアイコンを右クリックして設定画面が出せるようにした。
* 記号をUSキーボード風にする設定を追加

### 2021年6月19日
* (Naginata.ahk) 冗長シフトを復活
* (Conv.ahk)(init.ahk) 左右シフトを英数入力、かな入力からコンパイル前に選択
* (Conv.ahk) ATOK可のとき、秀丸エディタの使用時とそれ以外でディレイを自動変更
* (Conv.ahk)(init.ahk) シフトを押しながらの同時押しに制限時間を設けた

### 2021年5月28日
* (Conv.ahk) ATOK の自動検出を廃止。

### 2021年5月24日
* (Conv.ahk) Microsoft Word に対応させるための応急処置

### 2021年5月23日
* (Naginata.ahk)(Conv.ahk)(init.ahk) 固有名詞の定義方法を変更。全角・半角ともにそのまま入力されるようにした。
* (Conv.ahk) 何も出力しない {Null} を定義した。「Q」単打などに使用。
* (Conv.ahk) ATOK 対策の強化と、ATOK の誤検出を減らす対策。
* (NaginataTable.ahk)(OldNaginataTable.ahk) 固有名詞ショートカット(U+I)を押し続けて、前文字削除(U)のリピートが起きる場合があるので対策

### 2021年5月22日
* (Conv.ahk)(init.ahk) 記号入力と固有名詞をIMEオフにして出力するように変更。その際の ATOK 対策。

### 2021年5月10日
* (Conv.ahk)(init.ahk) ユニコード文字の前後で、ディレイを置きつつ未確定状態が検出できたら確定するように変更。

ATOK でストアアプリに記号入力すると、「ん」を入力したままになってしまったため。

ATOK で全角空白をユニコード入力すると、変換途中にも関わらず未確定状態として認識できないので、対策をした。

### 2021年4月28日
* (Conv.ahk) かなと英数を切り変えた時、薙刀式に変換せずにそのまま通ってしまうことがあるのを軽減(失敗)

### 2021年4月24日
* (Conv.ahk) 後置シフト有効時に、３キー同時→３キー同時でロールオーバーができなかったのを直した
* (Conv.ahk) 後置シフトの判定期限に確定できる時は、出力する

### 2021年4月20日
* (IME.ahk) コメント追加
* (Conv.ahk) 薙刀式に変換せずにそのまま通ってしまうことがあるのを修正(失敗)

### 2021年4月11日
* (Conv.ahk) タスクトレイメニューに“縦書きモード”切り替えを追加

### 2021年4月8日
* (Conv.ahk) 後置シフトが有効の時だけ、高精度タイマーを使うようにした

### 2021年3月14日
* ファイル構成の変更
* 時限式の後置シフトを実装(初期設定は通常シフト)

Naginata.ahk 24行目に設定があります。
たとえば後置シフトを60ミリ秒まで認める場合、
ShiftDelay := 60
とします。

* 冗長シフトの削除

Naginata.ahk 17行目を
#Include KanaTable/OldNaginataTable.ahk
と書き換えれば、以前のものと同じになります。
このとき後置シフトにすると、どれかキーを上げるまで字が入らないことがあります。

### 2021年3月1日
* (KanaTable.ahk) 内容は薙刀式創作者である大岡様の著作物のため、著作権表記を変更した。

### 2021年2月27日
* (Naginata.ahk) キーを離してもシフトが残ることがあるのを修正

### 2021年2月26日
* (KanaTable.ahk) Shift+ろ → ＿

### 2021年2月24日
* (init.ahk) × はユニコード文字でないことがわかったので、調整
* (Naginata.ahk) ATOK に対応させるために出力タイミングを調整

### 2021年2月23日
* (Naginata.ahk) スペースキーを押しながらのカーソルキー、Home、End、PageUp、PageDown をシフトキーを押しながらと同じ動作になるようにした
* (init.ahk) ユニコード文字の前後でかな入力を確定する操作を入れた。「nn」→Control+Enter→BS
* (init.ahk)(KanaTable.ahk) そのため、{確定} {固定} 機能を廃止

### 2021年2月21日
* 編集モードでロールオーバーができない組み合わせを解消した
* (init.ahk) {確定}機能を再実装。Ctrl+Enter を入力します。
* (init.ahk) {固定}機能を実装。「n」→改行→BS を入力します。新MS-IMEでユニコード入力の前に使います。
* (KanaTable.ahk) 記号入力で改行されすぎる不具合の再度の解消
* (Naginata.ahk) 入力バッファの大きさを調節(キーを押す時は6個残す)

すべてのファイルを入れ替えた場合のみ、修正が有効になります。

### 2021年2月19日
* 同じキーを連打して取りこぼすことが、主に編集モードで起きていたのを解消した
* Shift + 半角/全角 の動作を直した

### 2021年2月18日
* 出力速度の最適化
* ディレイの設定を不要にした。ある場合はこれまでと同様の動作、ない場合は自動設定される。

### 2021年2月13日
* (Naginata.ahk) 入力部分の強化
* (init.ahk) 定義をされているかなを元に戻せるようにした
* (KanaTable.ahk) 一部かな定義の間違いを訂正。ディレイの修正

### 2021年2月12日
* (Naginata.ahk) リセット機能の不完全な実装を解消
* (KanaTable.ahk) 何も入力しない「Q」単打は、Windows が無反応だった頃の「かな」キーのスキャンコードを出力するように変更

### 2021年2月11日
* (Naginata.ahk) リセット機能を強化
* (init.ahk) {確定}機能の最初の実装
* (KanaTable.ahk) 記号入力で改行されすぎる不具合の解消

### 2021年2月10日
* (KanaTable.ahk) エクスプローラーの検索欄で入力が失敗する、３文字のローマ字のディレイを設定し直した

### 2021年2月9日
* (Naginata.ahk) 例えば「う」押す→「スペース」押す→「う」離す、でスペースが発行されていたのを修正（大岡様ありがとうございました）
* (Naginata.ahk) 3キー以上を限りなく同時に押すと、2文字までしか入力されないことがある、のを修正
